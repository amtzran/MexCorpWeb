<ngx-spinner></ngx-spinner>

<div fxLayout="row"
     fxLayoutGap="10px"
     fxLayout.lg="row"
     fxLayout.md="column"
     fxLayout.xs="column">

  <div class="container"
       fxFlex="100"
       fxLayout="column"
       fxLayout.xs="column"
       [formGroup]="calendarForm">

    <div fxLayout="row"
         fxLayout.xs="column"
         fxLayout.sm="column"
         fxLayoutGap="10px">

      <div fxFlex="100" fxLayoutAlign="center center">
      <button mat-button color="primary" (click)="openDialogTask(true,null,false,null, false, true)">
        MÃºltiples Tareas
        <mat-icon mat-list-icon >task</mat-icon>
      </button>
      </div>

      <ng-select fxFlex="100"
                 bindLabel="name"
                 placeholder="Clientes"
                 formControlName="customer"
                 [multiple]="false"
                 appendTo="body"
                 [searchable]="true"
                 [clearable]="true"
                 (change)="filterSelectCustomer($event)">
        <ng-option value="">TODOS</ng-option>
        <ng-option *ngFor="let customer of customers" [value]="customer.id">
          {{customer.name}}
        </ng-option>
      </ng-select>

      <mat-form-field fxFlex="100">
        <mat-label>Empleados</mat-label>
        <mat-select formControlName="employee"
                    (selectionChange)="filterSelectEmployee($event.value)">
          <mat-option value="">TODOS</mat-option>
          <mat-option *ngFor="let employee of employees" [value]="employee.id">
            {{ employee.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field fxFlex="100">
        <mat-label>Grupos</mat-label>
        <mat-select formControlName="job_center"
                    (selectionChange)="filterSelectJobCenter($event.value)">
          <mat-option value="">TODOS</mat-option>
          <mat-option *ngFor="let jobCenter of jobCenters" [value]="jobCenter.id">
            {{ jobCenter.name}}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field fxFlex="100">
        <mat-label>Estatus</mat-label>
        <mat-select formControlName="status"
                    (selectionChange)="filterSelectStatus($event.value)">
          <mat-option value="">TODOS</mat-option>
          <mat-option value="Finalizado">Finalizado</mat-option>
          <mat-option value="Programado">Programado</mat-option>
          <mat-option value="En Proceso">En Proceso</mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field fxFlex="100">
        <mat-label>Tipos de Trabajo</mat-label>
        <mat-select formControlName="work_type">
          <mat-option value="">TODOS</mat-option>
          <mat-option *ngFor="let workType of workTypes" [value]="workType.id">
            {{ workType.name }}
          </mat-option>
        </mat-select>
      </mat-form-field>

      <mat-form-field fxFlex="100">

        <mat-label>Ingresar Rango Fecha</mat-label>
        <mat-date-range-input [rangePicker]="picker">
          <input matStartDate formControlName="initial_date" placeholder="Fecha Inicial">
          <input matEndDate formControlName="final_date" placeholder="Fecha Final">
        </mat-date-range-input>
        <mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-date-range-picker #picker></mat-date-range-picker>
        <mat-error *ngIf="fieldInvalid('initial_date')">
          Favor de ingresar el rango
        </mat-error>

      </mat-form-field>

      <div fxFlex="100" fxLayoutAlign="center center">

      <button mat-button color="primary" [matMenuTriggerFor]="menu" [disabled]="calendarForm.invalid">Reportes</button>
      <mat-menu #menu="matMenu">
        <button mat-menu-item color="warn" (click)="reportTaskPdf()" [disabled]="calendarForm.invalid">
          General Tareas
          <mat-icon mat-list-icon>picture_as_pdf</mat-icon>
        </button>
        <button mat-menu-item color="warn" (click)="reportCalendarPdf()" [disabled]="calendarForm.invalid">
          Calendario
          <mat-icon mat-list-icon>picture_as_pdf</mat-icon>
        </button>
        <button mat-menu-item color="warn" (click)="downloadReport('pdf')" [disabled]="calendarForm.invalid">
          Tareas
          <mat-icon mat-list-icon>picture_as_pdf</mat-icon>
        </button>
        <button mat-menu-item color="primary" (click)="downloadReport('excel')" [disabled]="calendarForm.invalid">
          Tareas (Excel)
          <mat-icon mat-list-icon >view_list</mat-icon>
        </button>
      </mat-menu>

      </div>

    </div>

  </div>

</div>

<div>
  <full-calendar #calendar [options]="calendarOptions" ></full-calendar>
</div>
